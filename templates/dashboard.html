<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Legal Document Demystifier</title>
  <script>
  const userLanguage = "{{ language }}";
  const translations = {
  "English": {
    "glance": "At-a-Glance",
    "agents": "Agents",
    "summarizer": "Case Summarizer",
    "jargons": "Legal Term Simplifier",
    "timeline": "Case Progress Timeline",
    "graph": "Case Relationship Map",
    "thinker": "Interactive Legal Assistant",
    "related": "Related / Landmark Cases",
    "readiness": "Pre-Hearing Readiness"
  },
  "Hindi": {
    "glance": "‡§è‡§ï ‡§®‡§ú‡§º‡§∞ ‡§Æ‡•á‡§Ç",
    "agents": "‡§è‡§ú‡•á‡§Ç‡§ü‡•ç‡§∏",
    "summarizer": "‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§ï‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂",
    "jargons": "‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∂‡§¨‡•ç‡§¶‡•ã‡§Ç ‡§ï‡§æ ‡§∏‡§∞‡§≤ ‡§∞‡•Ç‡§™",
    "timeline": "‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§ï‡•Ä ‡§™‡•ç‡§∞‡§ó‡§§‡§ø ‡§∏‡§Æ‡§Ø‡§∞‡•á‡§ñ‡§æ",
    "graph": "‡§Æ‡§æ‡§Æ‡§≤‡•á ‡§ï‡§æ ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§Æ‡§æ‡§®‡§ö‡§ø‡§§‡•ç‡§∞",
    "thinker": "‡§á‡§Ç‡§ü‡§∞‡•à‡§ï‡•ç‡§ü‡§ø‡§µ ‡§ï‡§æ‡§®‡•Ç‡§®‡•Ä ‡§∏‡§π‡§æ‡§Ø‡§ï",
    "related": "‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ / ‡§™‡•ç‡§∞‡§∏‡§ø‡§¶‡•ç‡§ß ‡§Æ‡§æ‡§Æ‡§≤‡•á",
    "readiness": "‡§™‡•Ç‡§∞‡•ç‡§µ-‡§∏‡•Å‡§®‡§µ‡§æ‡§à ‡§§‡•à‡§Ø‡§æ‡§∞‡•Ä"
  },
  "Bengali": {
    "glance": "‡¶è‡¶ï ‡¶®‡¶ú‡¶∞‡ßá",
    "agents": "‡¶è‡¶ú‡ßá‡¶®‡ßç‡¶ü‡¶∏",
    "summarizer": "‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™",
    "jargons": "‡¶Ü‡¶á‡¶®‡¶ø ‡¶∂‡¶¨‡ßç‡¶¶‡ßá‡¶∞ ‡¶∏‡¶∞‡¶≤ ‡¶¨‡ßç‡¶Ø‡¶æ‡¶ñ‡ßç‡¶Ø‡¶æ",
    "timeline": "‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∞‡ßá‡¶ñ‡¶æ",
    "graph": "‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï ‡¶Æ‡¶æ‡¶®‡¶ö‡¶ø‡¶§‡ßç‡¶∞",
    "thinker": "‡¶á‡¶®‡ßç‡¶ü‡¶æ‡¶∞‡¶Ö‡ßç‡¶Ø‡¶æ‡¶ï‡¶ü‡¶ø‡¶≠ ‡¶Ü‡¶á‡¶®‡¶ø ‡¶∏‡¶π‡¶æ‡¶Ø‡¶º‡¶ï",
    "related": "‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ / ‡¶≤‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶°‡¶Æ‡¶æ‡¶∞‡ßç‡¶ï ‡¶Æ‡¶æ‡¶Æ‡¶≤‡¶æ",
    "readiness": "‡¶™‡ßÇ‡¶∞‡ßç‡¶¨-‡¶∂‡ßÅ‡¶®‡¶æ‡¶®‡¶ø‡¶∞ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡¶ø"
  },
  "Marathi": {
    "glance": "‡§è‡§ï ‡§®‡§ú‡§∞",
    "agents": "‡§è‡§ú‡§Ç‡§ü‡•ç‡§∏",
    "summarizer": "‡§™‡•ç‡§∞‡§ï‡§∞‡§£‡§æ‡§ö‡§æ ‡§∏‡§æ‡§∞‡§æ‡§Ç‡§∂",
    "jargons": "‡§ï‡§æ‡§Ø‡§¶‡•á‡§∂‡•Ä‡§∞ ‡§∂‡§¨‡•ç‡§¶‡§æ‡§Ç‡§ö‡•á ‡§∏‡•ã‡§™‡•á ‡§∞‡•Ç‡§™",
    "timeline": "‡§™‡•ç‡§∞‡§ï‡§∞‡§£‡§æ‡§ö‡•ç‡§Ø‡§æ ‡§™‡•ç‡§∞‡§ó‡§§‡•Ä‡§ö‡•Ä ‡§µ‡•á‡§≥‡§∞‡•á‡§∑‡§æ",
    "graph": "‡§™‡•ç‡§∞‡§ï‡§∞‡§£ ‡§∏‡§Ç‡§¨‡§Ç‡§ß ‡§®‡§ï‡§æ‡§∂‡§æ",
    "thinker": "‡§∏‡§Ç‡§µ‡§æ‡§¶‡•Ä ‡§ï‡§æ‡§Ø‡§¶‡•á‡§∂‡•Ä‡§∞ ‡§∏‡§π‡§æ‡§Ø‡•ç‡§Ø‡§ï",
    "related": "‡§∏‡§Ç‡§¨‡§Ç‡§ß‡§ø‡§§ / ‡§≤‡§Å‡§°‡§Æ‡§æ‡§∞‡•ç‡§ï ‡§™‡•ç‡§∞‡§ï‡§∞‡§£‡•á",
    "readiness": "‡§™‡•Ç‡§∞‡•ç‡§µ-‡§∂‡•Å‡§®‡§æ‡§µ‡§£‡•Ä ‡§§‡§Ø‡§æ‡§∞‡•Ä"
  },
  "Kannada": {
    "glance": "‡≤í‡≤Ç‡≤¶‡≥Å ‡≤®‡≥ã‡≤ü‡≤¶‡≤≤‡≥ç‡≤≤‡≤ø",
    "agents": "‡≤è‡≤ú‡≥Ü‡≤Ç‡≤ü‡≥ç‡≤ó‡≤≥‡≥Å",
    "summarizer": "‡≤ï‡≥á‡≤∏‡≥ç ‡≤∏‡≤æ‡≤∞‡≤æ‡≤Ç‡≤∂",
    "jargons": "‡≤ï‡≤æ‡≤®‡≥Ç‡≤®‡≥Å ‡≤™‡≤¶‡≤ó‡≤≥ ‡≤∏‡≤∞‡≤≥ ‡≤∞‡≥Ç‡≤™",
    "timeline": "‡≤™‡≥ç‡≤∞‡≤ï‡≤∞‡≤£‡≤¶ ‡≤™‡≥ç‡≤∞‡≤ó‡≤§‡≤ø ‡≤∏‡≤Æ‡≤Ø‡≤™‡≤ü‡≥ç‡≤ü‡≤ø",
    "graph": "‡≤™‡≥ç‡≤∞‡≤ï‡≤∞‡≤£ ‡≤∏‡≤Ç‡≤¨‡≤Ç‡≤ß ‡≤®‡≤ï‡≥ç‡≤∑‡≥Ü",
    "thinker": "‡≤Ö‡≤Ç‡≤§‡≤∞‡≤ï‡≥ç‡≤∞‡≤ø‡≤Ø‡≤æ‡≤§‡≥ç‡≤Æ‡≤ï ‡≤ï‡≤æ‡≤®‡≥Ç‡≤®‡≥Å ‡≤∏‡≤π‡≤æ‡≤Ø‡≤ï",
    "related": "‡≤∏‡≤Ç‡≤¨‡≤Ç‡≤ß‡≤ø‡≤§ / ‡≤≤‡≥ç‡≤Ø‡≤æ‡≤Ç‡≤°‡≥ç‚Äå‡≤Æ‡≤æ‡≤∞‡≥ç‡≤ï‡≥ç ‡≤™‡≥ç‡≤∞‡≤ï‡≤∞‡≤£‡≤ó‡≤≥‡≥Å",
    "readiness": "‡≤™‡≥Ç‡≤∞‡≥ç‡≤µ-‡≤∂‡≥Å‡≤£‡≤æ‡≤µ‡≤£‡≤æ ‡≤∏‡≤ø‡≤¶‡≥ç‡≤ß‡≤§‡≥Ü"
  },
  "Telugu": {
    "glance": "‡∞í‡∞ï ‡∞ö‡±Ç‡∞™‡±Å‡∞≤‡±ã",
    "agents": "‡∞è‡∞ú‡±Ü‡∞Ç‡∞ü‡±ç‡∞≤‡±Å",
    "summarizer": "‡∞ï‡±á‡∞∏‡±Å ‡∞∏‡∞æ‡∞∞‡∞æ‡∞Ç‡∞∂‡∞Ç",
    "jargons": "‡∞®‡±ç‡∞Ø‡∞æ‡∞Ø ‡∞™‡∞¶‡∞æ‡∞≤ ‡∞∏‡±Å‡∞≤‡∞≠ ‡∞µ‡∞ø‡∞µ‡∞∞‡∞£",
    "timeline": "‡∞ï‡±á‡∞∏‡±Å ‡∞™‡±Å‡∞∞‡±ã‡∞ó‡∞§‡∞ø ‡∞ü‡±à‡∞Æ‡±ç‚Äå‡∞≤‡±à‡∞®‡±ç",
    "graph": "‡∞ï‡±á‡∞∏‡±Å ‡∞∏‡∞Ç‡∞¨‡∞Ç‡∞ß ‡∞Æ‡±ç‡∞Ø‡∞æ‡∞™‡±ç",
    "thinker": "‡∞á‡∞Ç‡∞ü‡∞∞‡∞æ‡∞ï‡±ç‡∞ü‡∞ø‡∞µ‡±ç ‡∞®‡±ç‡∞Ø‡∞æ‡∞Ø ‡∞∏‡∞π‡∞æ‡∞Ø‡∞ï‡±Å‡∞°‡±Å",
    "related": "‡∞∏‡∞Ç‡∞¨‡∞Ç‡∞ß‡∞ø‡∞§ / ‡∞≤‡±ç‡∞Ø‡∞æ‡∞Ç‡∞°‡±ç‚Äå‡∞Æ‡∞æ‡∞∞‡±ç‡∞ï‡±ç ‡∞ï‡±á‡∞∏‡±Å‡∞≤‡±Å",
    "readiness": "‡∞™‡±Ç‡∞∞‡±ç‡∞µ-‡∞∂‡±Å‡∞®‡∞æ‡∞ï‡∞æ‡∞≤ ‡∞∏‡∞ø‡∞¶‡±ç‡∞ß‡∞§"
  },
  "Tamil": {
    "glance": "‡Æí‡Æ∞‡ØÅ ‡Æ™‡Ææ‡Æ∞‡Øç‡Æµ‡Øà‡ÆØ‡Æø‡Æ≤‡Øç",
    "agents": "‡ÆÆ‡ØÅ‡Æï‡Æµ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç",
    "summarizer": "‡Æµ‡Æ¥‡Æï‡Øç‡Æï‡Æø‡Æ©‡Øç ‡Æö‡ØÅ‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ÆÆ‡Øç",
    "jargons": "‡Æö‡Æü‡Øç‡Æü‡Æö‡Øç ‡Æö‡Øä‡Æ±‡Øç‡Æï‡Æ≥‡Æø‡Æ©‡Øç ‡Æé‡Æ≥‡Æø‡ÆØ ‡Æµ‡Æø‡Æ≥‡Æï‡Øç‡Æï‡ÆÆ‡Øç",
    "timeline": "‡Æµ‡Æ¥‡Æï‡Øç‡Æï‡Æø‡Æ©‡Øç ‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æ©‡Øá‡Æ±‡Øç‡Æ± ‡Æï‡Ææ‡Æ≤‡Æµ‡Æ∞‡Æø‡Æö‡Øà",
    "graph": "‡Æµ‡Æ¥‡Æï‡Øç‡Æï‡ØÅ ‡Æâ‡Æ±‡Æµ‡ØÅ ‡Æµ‡Æ∞‡Øà‡Æ™‡Æü‡ÆÆ‡Øç",
    "thinker": "‡Æá‡Æ£‡Øà‡ÆØ‡Ææ‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æö‡Æü‡Øç‡Æü ‡Æâ‡Æ§‡Æµ‡Æø‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç",
    "related": "‡Æö‡ÆÆ‡Øç‡Æ™‡Æ®‡Øç‡Æ§‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü / ‡Æ®‡Æø‡Æ≤‡Øà‡ÆÆ‡Øà‡ÆØ‡Æø‡Æ≤‡Ææ‡Æ© ‡Æµ‡Æ¥‡Æï‡Øç‡Æï‡ØÅ‡Æï‡Æ≥‡Øç",
    "readiness": "‡ÆÆ‡ØÅ‡Æ©‡Øç-‡Æï‡Øá‡Æ≥‡Øç‡Æµ‡Æø ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Ææ‡Æï ÏûàÏùå"
  }
};


  document.addEventListener("DOMContentLoaded", () => {
    // Get the correct translation object, defaulting to English
    const t = translations[userLanguage] || translations["English"];

    // === 1. Translate Sidebar Header ===
    document.querySelector(".sidebar h2").innerText = t.agents;

    // === 2. Translate Sidebar List Items (The clean way) ===
    // Select ALL list items that have a 'data-panel' attribute
    const panelItems = document.querySelectorAll(".sidebar li[data-panel]");

    // Loop through each item
    panelItems.forEach(item => {
      // Get the value of the 'data-panel' attribute (e.g., "summary", "jargons")
      const panelKey = item.dataset.panel; 
      
      // If that key exists in our translation object (e.g., t['summary'])
      if (t[panelKey]) {
        // Set the item's display text to the translated value
        item.innerText = t[panelKey];
      }
    });

    // === 3. Translate Panel Headings ===
    // This part was correct, but I've matched the keys for clarity
    document.querySelector("#summary h2").innerText = t.summarizer;
    document.querySelector("#jargons h2").innerText = t.jargons;
    document.querySelector("#timeline h2").innerText = t.timeline;
    document.querySelector("#graph h2").innerText = t.graph;
    document.querySelector("#thinker h2").innerText = t.thinker;
    document.querySelector("#related h2").innerText = t.related;
    document.querySelector("#readiness h2").innerText = t.readiness;
  });

</script>


  <!-- Styles -->
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}" />

  <!-- Markdown & Sanitizer -->
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.1.6/dist/purify.min.js"></script>
</head>

<body>
  <!-- üß≠ Sidebar -->
  <div class="sidebar">
    <h2>Agents</h2>
    <ul>
      <li data-panel="glance" class="active"> At-a-Glance</li>
      <li data-panel="summary"> Summarizer</li>
      <li data-panel="jargons"> Jargons and Terms</li>
      <li data-panel="timeline"> Timeline</li>
      <li data-panel="graph"> Graph</li>
      <li data-panel="readiness">Pre-Hearing Readiness</li>
      <li data-panel="related"> Related Cases</li>
      <li data-panel="thinker"> Thinker</li>
    <li class="change-lang" onclick="window.location.href='/'">
      Change Language
    </li>
  </ul>
</div>

<style>
/* Sidebar container layout fix */
.sidebar {
  display: flex;
  flex-direction: column;
  height: 100vh;
  justify-content: space-between;
  background: rgba(255, 255, 255, 0.04);
  border-right: 1px solid rgba(255, 255, 255, 0.08);
  padding: 30px 20px;
  backdrop-filter: blur(20px);
}

/* Agent list */
.sidebar ul {
  list-style: none;
  padding: 0;
  margin: 0;
  flex-grow: 1;
  display: flex;
  flex-direction: column;
}

/* Agent item */
.sidebar li {
  padding: 12px 16px;
  margin: 6px 0;
  border-radius: 10px;
  cursor: pointer;
  transition: all 0.3s ease;
  font-size: 15px;
  color: #a8b2d1;
  background: transparent;
}

/* Hover + active states */
.sidebar li:hover {
  background: rgba(155, 233, 255, 0.12);
  color: #fff;
}

.sidebar li.active {
  background: linear-gradient(90deg, #40c9ff, #e81cff);
  color: white;
  font-weight: 600;
  box-shadow: 0 0 8px #40c9ff99;
}

/* üåê Change language style (bottom list item) */
.sidebar li.change-lang {
  margin-top: 100px;
  background: linear-gradient(90deg, #40c9ff, #e81cff);
  color: white;
  text-align: center;
  font-weight: 600;
  transition: all 0.3s ease;
}

.sidebar li.change-lang:hover {
  transform: scale(1.05);
  box-shadow: 0 0 15px #40c9ff88;
}
</style>
  

  <!-- üß± Main Content Area -->
  <div class="content">

    <!-- üß† SUMMARIZER PANEL -->
    <div id="summary" class="panel">
      <h2>Summarizer</h2>
      <div id="summary-content"
           class="markdown-box"
           data-md='{{ summary|tojson|safe }}'></div>
      <script>
        document.addEventListener("DOMContentLoaded", () => {
          const summaryEl = document.getElementById("summary-content");
          const md = {{ summary|tojson }};
          summaryEl.innerHTML = marked.parse(md || "Upload a file to begin analysis.");
        });
      </script>
    </div>
    

    <!-- üìò JARGONS PANEL -->
    <div id="jargons" class="panel">
  <h2>Legal Terms and Jargons</h2>
  <div id="jargon-output" class="markdown-box">‚öôÔ∏è Extracting...</div>
    </div>

    <script>
    document.addEventListener("DOMContentLoaded", async () => {
      const jargonBox = document.getElementById("jargon-output");
      try {
        const res = await fetch("/api/jargons", { method: "POST" });
        const data = await res.json();
        jargonBox.innerHTML = DOMPurify.sanitize(marked.parse(data.output || "‚ö†Ô∏è No terms found."));
      } catch {
        jargonBox.innerHTML = "‚ö†Ô∏è Failed to load jargons.";
      }
    });
    </script>

    

    <!-- üïí TIMELINE PANEL -->
    <div id="timeline" class="panel">
      <h2>Case Timeline</h2>
      <div id="timelineContainer" style="margin-top:20px;"></div>

      <!-- Vis.js Timeline -->
      <link href="https://cdn.jsdelivr.net/npm/vis-timeline@7.7.0/styles/vis-timeline-graph2d.min.css" rel="stylesheet" />
      <script src="https://cdn.jsdelivr.net/npm/vis-timeline@7.7.0/standalone/umd/vis-timeline-graph2d.min.js"></script>
    </div>
    
    <script>
document.addEventListener("DOMContentLoaded", async () => {
  const container = document.getElementById("timelineContainer");
  if (!container) return;

  container.innerHTML = "<p style='color:#aaa;'>üìÑ Extracting timeline...</p>";

  try {
    const res = await fetch("/api/timeline", { method: "POST" });
    const data = await res.json();
    let timelineData = [];

    try {
      timelineData = JSON.parse(data.output);
    } catch {
      console.warn("Timeline parse error:", data.output);
      container.innerHTML = "<p>‚ö†Ô∏è Invalid timeline data.</p>";
      return;
    }

    if (!Array.isArray(timelineData) || timelineData.length === 0) {
      container.innerHTML = "<p>‚ö†Ô∏è No timeline events found.</p>";
      return;
    }

   // ‚úÖ FIXED TIMELINE CODE
const items = new vis.DataSet(
  timelineData.map((e, i) => {
    const isStage = e.date && e.date.toLowerCase().includes("stage");
    
    // Create a sequential placeholder date if it's a stage (e.g., Jan 1 2000 ‚Üí Jan 2 2000 ‚Üí ‚Ä¶)
    const startDate = isStage
      ? new Date(2000, 0, parseInt(e.date.replace(/\D/g, ""), 10) || i + 1)
      : new Date(e.date); // fallback to actual date if valid

    return {
      id: i + 1,
      content: `<b>${e.title}</b><br>${e.description}`,
      start: startDate
      };
    })
  );

    const options = {
      orientation: "top",
      zoomable: true,
      moveable: true,
      width: "100%",
      height: "500px",
      margin: { item: 15 },
      selectable: false,
      tooltip: { followMouse: true },
    };

    new vis.Timeline(container, items, options);
  } catch (err) {
    console.error(err);
    container.innerHTML = "<p>‚ö†Ô∏è Failed to generate timeline.</p>";
  }
});
</script>

    <div id="graph" class="panel">
    <h2>Case Relationship Graph</h2>
    <div id="graphContainer" style="width:100%; height:600px; margin-top:20px;"></div>
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </div>


    <!-- üîó RELATED CASES PANEL -->
  <div id="related" class="panel">
    <h2>Related Cases</h2>
    <div id="related-content" class="markdown-box">‚öôÔ∏è Searching for similar cases...</div>
  </div>

  <script>
  document.addEventListener("DOMContentLoaded", async () => {
    const relatedBox = document.getElementById("related-content");
    if (!relatedBox) return;

    try {
      const res = await fetch("/api/related_cases", { method: "POST" });
      const data = await res.json();
      relatedBox.innerHTML = DOMPurify.sanitize(marked.parse(data.output || "‚ö†Ô∏è No related cases found."));
    } catch {
      relatedBox.innerHTML = "‚ö†Ô∏è Failed to load related cases.";
    }
  });
  </script>

  <!-- üßæ PRE-HEARING READINESS PANEL -->
<div id="readiness" class="panel">
  <h2>üßæ Pre-Hearing Readiness</h2>
  <div id="readiness-content" class="markdown-box">‚öôÔ∏è Preparing readiness brief...</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const readinessBox = document.getElementById("readiness-content");
  if (!readinessBox) return;

  try {
    const res = await fetch("/api/readiness", { method: "POST" });
    const data = await res.json();
    readinessBox.innerHTML = DOMPurify.sanitize(marked.parse(data.output || "‚ö†Ô∏è No readiness insights available."));
  } catch {
    readinessBox.innerHTML = "‚ö†Ô∏è Failed to load readiness report.";
  }
});
</script>

<!-- ‚ö° AT-A-GLANCE SUMMARY PANEL -->
<div id="glance" class="panel active">
  <h2>‚ö° At-a-Glance Summary</h2>
  <div id="glance-content" class="markdown-box">‚öôÔ∏è Generating overview...</div>
</div>

<script>
document.addEventListener("DOMContentLoaded", async () => {
  const glanceBox = document.getElementById("glance-content");
  if (!glanceBox) return;

  try {
    const res = await fetch("/api/glance", { method: "POST" });
    const data = await res.json();
    glanceBox.innerHTML = DOMPurify.sanitize(marked.parse(data.output || "‚ö†Ô∏è No summary available."));
  } catch {
    glanceBox.innerHTML = "‚ö†Ô∏è Failed to load at-a-glance summary.";
  }
});
</script>


<!-- üí≠ THINKER CHAT PANEL -->
    <div id="thinker" class="panel">
      <h2>Thinker (Chat Agent)</h2>
      <div id="chat-box" class="chat-box"></div>
      <div class="chat-input">
        <textarea id="user-input" placeholder="Ask anything about your case or position..."></textarea>
        <button id="sendBtn">Send</button>
      </div>
    </div>

  </div> <!-- ‚úÖ CLOSES .content -->

  <!-- JS Logic -->
  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>